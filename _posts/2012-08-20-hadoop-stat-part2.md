---
layout: default
published: true
---

# Hadoop统计平台——MMStat（二）  

## 数据结构

如果直接就把方案写出来，其实理解起来会有种“中国式教育”的味道。所以我还是打算先提出当时遇到的问题。  
如果现在我想统计2012-08-20这一天“美丽说”这个app的iphone平台上2.5.8版本的“最新宝贝”浏览页的PV数和设备数，那么要怎么解决这个问题？很明显我只需要输出当天日志文件的所有内容，然后分别grep：美丽说、iPhone、2.5.8、最新宝贝的浏览请求，最后提取一个日志数还有抽取其中的设备号并去重，那我就可以达到目标。  
那如果现在需要的是另一个版本2.5.9的同样的数据呢？好吧，我还是可以输出当天日志再重新grep一把，但问题很快就会升级到需要看各个版本的同一个数据，如果历史有过10个版本，那么同样的日志内容就会被输出10遍，然而真正的问题并不在这里，而是有可能不需要看分版本的数据，需要聚合起来，然而这一次变成要看不同的设备平台的数据，例如iphone、android和ipad；又或者除了不同的设备和不同的版本，PM、RD和leader们还需要看不同的app还有不单只是“最新宝贝”浏览请求的设备和PV，还有别的其他N个请求，说到这里基本上以我的语文水平，可能你已经有点晕，但无论晕还是不晕，该看的，该计算的还是得做出来。  

